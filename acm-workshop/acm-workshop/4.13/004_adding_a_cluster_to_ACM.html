<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Adding an Existing Cluster to ACM :: Clusters and Governance</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () { 
      const urlParams = new URLSearchParams(window.location.search);
      const clusterName = urlParams.get('CLUSTER_SUBDOMAIN');
      const projectName = urlParams.get('PROJECT');
      if (clusterName) {
        showCluster( clusterName );
      }
      else {
        showClusterForm();
      }

      if (projectName) {
        showProject( projectName );
      } else {
        showProjectForm();
      }
    } );


    function sliceCluster(clusterName){
      if (clusterName.length > 70) {
          return "..." + clusterName.slice(35);
      } else {
          return clusterName;
      }
    }

    function showCluster( clusterName ) {
      document.getElementById('navbar-form-empty').style.display = "none";
      document.getElementById('navbar-form-filled').style.display = "flex";
      document.getElementById('cluster_subdomain').textContent = sliceCluster(clusterName);
      document.getElementById('clusterfield2').value = clusterName;

    }

    function showClusterForm( clusterName ) {
      document.getElementById('navbar-form-empty').style.display = "flex";
      document.getElementById('navbar-form-filled').style.display = "none";
    }

    function gowithcluster() {
      elClusterInput = document.getElementById('clusterfield');
      elProjectInput = document.getElementById('projectfield2');

      window.location.search = ('&CLUSTER_SUBDOMAIN=' + elClusterInput.value + '&PROJECT=' + elProjectInput.value);
    }

    function showProject( projectName ) {
      document.getElementById('navbar-form-project-empty').style.display = "none";
      document.getElementById('navbar-form-project-filled').style.display = "flex";
      document.getElementById('project').textContent = projectName;
      document.getElementById('projectfield2').value = projectName;
    }

    function showProjectForm( projectName ) {
      document.getElementById('navbar-form-project-empty').style.display = "flex";
      document.getElementById('navbar-form-project-filled').style.display = "none";
    }

    function gowithproject() {
      elProjectInput = document.getElementById('projectfield');
      elClusterInput = document.getElementById('clusterfield2');
      window.location.search = ('&CLUSTER_SUBDOMAIN=' + elClusterInput.value + '&PROJECT=' + elProjectInput.value);
    }

  </script>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="../..">Clusters and Governance</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item" id="navbar-form-empty">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>

          <form action="javascript:void(0);" onsubmit="gowithcluster();">
            <input size="40" id="clusterfield" type="text" placeholder="Enter Cluster Subdomain">
            <input type="hidden" id="projectfield2" name="projectfield2" value="">
          </form>
        </div>

        <div class="navbar-item" id="navbar-form-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
          <span class="navbar-text" id="cluster_subdomain"></span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i></span>
        </div>

         <div class="navbar-item" id="navbar-form-project-empty">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>

          <form action="javascript:void(0);" onsubmit="gowithproject();">
            <input size="40" id="projectfield" type="text" placeholder="Enter Project Name">
            <input type="hidden" id="clusterfield2" name="clusterfield2" value="">
          </form>
        </div>

        <div class="navbar-item" id="navbar-form-project-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
          <span class="navbar-text" id="project"></span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i></span>
        </div>
<!---
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-scholars.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
--->
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="acm-workshop" data-version="4.13">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Clusters and Governance</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="001_accessing_ACM.html">ACM &amp; AWS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="002_cluster_lifecycle.html">Cluster lifecycle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="003_create_cluster.html">Create cluster</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="004_adding_a_cluster_to_ACM.html">Adding a cluster to ACM</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="006_hcp_introduction.html">HCP Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="007_explore_environment.html">Explore HCP Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="008_deploy_cluster.html">Deploy HCP cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="005_governance.html">Governance</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Clusters and Governance</span>
    <span class="version">4.13</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Clusters and Governance</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">4.13</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Clusters and Governance</a></li>
    <li><a href="001_accessing_ACM.html">ACM &amp; AWS</a></li>
    <li><a href="004_adding_a_cluster_to_ACM.html">Adding a cluster to ACM</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/mroberts/data/git-repos/acm-workshop/documentation/modules/ROOT/pages/004_adding_a_cluster_to_ACM.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Adding an Existing Cluster to ACM</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>It is also possible to add clusters to ACM control for management and governance
that predate the installation of ACM.</p>
</div>
<div class="paragraph">
<p>You were given cluster URL and credentials for a single node OpenShift cluster that was not created by ACM, but we want to place it under ACM management.</p>
</div>
<div class="paragraph">
<p>To do this we are going to import the cluster into ACM.</p>
</div>
<div class="paragraph">
<p>Login to the bastion host associated with the single node OpenShift using the supplied credentials.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generating_the_import_command"><a class="anchor" href="#_generating_the_import_command"></a>Generating the import command</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On the ACM web user interface go to the <strong>clusters</strong> section and then select <strong>Import cluster</strong>.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Name the cluster : cluster-2-&lt;initials&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Leave the cluster set empty</p>
</div>
<div class="paragraph">
<p>Additional labels - Add a label of:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> environment=prod</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also add a label to identify clusters created by you. For this use:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lab-name=&lt;initials&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import mode : <strong>Run import command manually</strong></p>
</div>
<div class="paragraph">
<p>Click on the blue button marked: <strong>Save import and generate code</strong></p>
</div>
<div class="paragraph">
<p>You should then see a screen similar to below:</p>
</div>
<div class="imageblock left text-center">
<div class="content">
<img src="_images/ACM_cluster_import_cmd.png" alt="Cluster import cmd" width="6500px">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_executing_the_import_command"><a class="anchor" href="#_executing_the_import_command"></a>Executing the import command</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Click the <strong>Copy</strong> command button and paste the content into the ssh command window on the bastion host.</p>
</div>
<div class="paragraph">
<p>The command is a lot of text and will end with the line base64 -d.</p>
</div>
<div class="paragraph">
<p>You may see a warning about pod security and privilege escalation but that is not a problem in the demonstration environment.</p>
</div>
<div class="paragraph">
<p>Wait a couple of minutes for the Multi-Cluster Management operators to be installed into the single node openshift cluster. When this is complete and the cluster has ‘called home’ to the ACM hub you will see the new cluster appear in the list of clusters as shown below.</p>
</div>
<div class="imageblock left text-center">
<div class="content">
<img src="_images/ACM_imported_cluster.png" alt="Imported cluster" width="6500px">
</div>
</div>
<div class="paragraph">
<p>You can now exit the ssh shell of the single node OpenShift bastion host.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
